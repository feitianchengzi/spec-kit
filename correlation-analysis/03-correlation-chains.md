# å®ä½“é—´çš„å…³ç³»å’Œæ¼”è¿›è·¯çº¿

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°å„é˜¶æ®µå®ä½“ä¹‹é—´çš„å…·ä½“å…³ç³»é“¾è·¯ï¼Œå±•ç¤ºç”¨æˆ·éœ€æ±‚å¦‚ä½•ä¸€æ­¥æ­¥è½¬åŒ–ä¸ºå¯æ‰§è¡Œä»»åŠ¡ã€‚

---

## ğŸ”„ å…³ç³»é“¾è·¯ 1: ç”¨æˆ·æ•…äº‹ â†’ API ç«¯ç‚¹ â†’ å®ç°ä»»åŠ¡

è¿™æ˜¯æœ€æ ¸å¿ƒçš„æ¼”è¿›è·¯çº¿ï¼Œå±•ç¤ºäº†ç”¨æˆ·éœ€æ±‚å¦‚ä½•è½¬åŒ–ä¸ºå…·ä½“çš„ API å®ç°ã€‚

### æ¼”è¿›æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Spec.md: User_Story                            â”‚
â”‚  â”œâ”€ id: "US1"                                  â”‚
â”‚  â”œâ”€ title: "ç”¨æˆ·æ³¨å†Œ"                           â”‚
â”‚  â”œâ”€ priority: "P1"                             â”‚
â”‚  â”œâ”€ user_actions:                              â”‚
â”‚  â”‚   â”œâ”€ "å¡«å†™æ³¨å†Œä¿¡æ¯"                          â”‚
â”‚  â”‚   â”œâ”€ "æäº¤æ³¨å†Œ" â­                          â”‚
â”‚  â”‚   â””â”€ "æ¥æ”¶ç¡®è®¤é‚®ä»¶"                          â”‚
â”‚  â””â”€ acceptance_scenarios: [...]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Plan å‘½ä»¤åˆ†æ user_actions
                    â”‚ å°†æ¯ä¸ªå…³é”®åŠ¨ä½œæ˜ å°„ä¸º API ç«¯ç‚¹
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Contracts/auth.yaml: API_Endpoint              â”‚
â”‚  â”œâ”€ id: "register_user"                        â”‚
â”‚  â”œâ”€ path: "/api/v1/auth/register"              â”‚
â”‚  â”œâ”€ method: "POST"                             â”‚
â”‚  â”œâ”€ source_user_story: "US1" â­               â”‚
â”‚  â”œâ”€ source_user_action: "æäº¤æ³¨å†Œ" â­         â”‚
â”‚  â”œâ”€ request_schema:                            â”‚
â”‚  â”‚   â””â”€ {email, password, username}            â”‚
â”‚  â””â”€ response_schema:                           â”‚
â”‚      â””â”€ {201: user_created, 409: email_exists} â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Tasks å‘½ä»¤ç”Ÿæˆå®ç°ä»»åŠ¡
                    â”‚ æŒ‰ç…§ Tests â†’ Models â†’ Services â†’ Endpoints é¡ºåº
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tasks.md: Phase 3 (User Story 1)               â”‚
â”‚                                                 â”‚
â”‚ Tests (å¦‚æœè¯·æ±‚):                               â”‚
â”‚  â”œâ”€ T010 [P] [US1] Contract test for           â”‚
â”‚  â”‚   /api/v1/auth/register                     â”‚
â”‚  â”‚   â””â”€ file: tests/contract/test_auth_...py   â”‚
â”‚  â”‚                                              â”‚
â”‚ Models:                                         â”‚
â”‚  â”œâ”€ T012 [P] [US1] Create User model           â”‚
â”‚  â”‚   â””â”€ file: src/models/user.py               â”‚
â”‚  â”‚                                              â”‚
â”‚ Services:                                       â”‚
â”‚  â”œâ”€ T014 [US1] Implement AuthService.register()â”‚
â”‚  â”‚   â”œâ”€ depends_on: T012 (User model)          â”‚
â”‚  â”‚   â””â”€ file: src/services/auth_service.py     â”‚
â”‚  â”‚                                              â”‚
â”‚ Endpoints:                                      â”‚
â”‚  â””â”€ T015 [US1] Implement POST                  â”‚
â”‚      /api/v1/auth/register                     â”‚
â”‚      â”œâ”€ depends_on: T014 (AuthService)         â”‚
â”‚      â”œâ”€ file: src/api/v1/auth.py               â”‚
â”‚      â”œâ”€ related_endpoints: ["/api/v1/auth/..."]â”‚
â”‚      â””â”€ source: US1 "æäº¤æ³¨å†Œ" user action â­  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®è¿½æº¯ç‚¹

1. **API_Endpoint.source_user_action** â†’ **User_Story.user_actions**
   - æ¯ä¸ªç«¯ç‚¹éƒ½å¯ä»¥è¿½æº¯åˆ°å…·ä½“çš„ç”¨æˆ·åŠ¨ä½œ

2. **Task.related_endpoints** â†’ **API_Endpoint.path**
   - æ¯ä¸ªå®ç°ä»»åŠ¡éƒ½çŸ¥é“å®ƒåœ¨å®ç°å“ªä¸ª API

3. **Task.user_story_label** â†’ **User_Story.id**
   - æ¯ä¸ªä»»åŠ¡éƒ½æ ‡è®°äº†æ‰€å±çš„ç”¨æˆ·æ•…äº‹

---

## ğŸ”„ å…³ç³»é“¾è·¯ 2: å…³é”®å®ä½“ â†’ æ•°æ®æ¨¡å‹ â†’ Model ä»»åŠ¡

å±•ç¤ºæ¦‚å¿µå±‚é¢çš„å®ä½“å¦‚ä½•æ¼”è¿›ä¸ºæŠ€æœ¯å®ç°ã€‚

### æ¼”è¿›æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Spec.md: Key_Entity                            â”‚
â”‚  â”œâ”€ name: "User"                               â”‚
â”‚  â”œâ”€ description: "ç³»ç»Ÿç”¨æˆ·è´¦æˆ·"                 â”‚
â”‚  â”œâ”€ key_attributes:                            â”‚
â”‚  â”‚   â”œâ”€ "é‚®ç®±"ï¼ˆæ¦‚å¿µå±‚é¢ï¼‰                     â”‚
â”‚  â”‚   â”œâ”€ "å¯†ç "                                 â”‚
â”‚  â”‚   â”œâ”€ "ç”¨æˆ·å"                               â”‚
â”‚  â”‚   â””â”€ "æ³¨å†Œæ—¶é—´"                             â”‚
â”‚  â”œâ”€ relationships:                             â”‚
â”‚  â”‚   â””â”€ "ä¸€ä¸ªç”¨æˆ·æœ‰å¤šä¸ªè®¢å•"ï¼ˆæ¦‚å¿µæè¿°ï¼‰       â”‚
â”‚  â””â”€ related_user_stories: ["US1", "US2"]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Plan å‘½ä»¤ç»†åŒ–ä¸ºæ•°æ®æ¨¡å‹
                    â”‚ æ·»åŠ ç±»å‹ã€çº¦æŸã€éªŒè¯è§„åˆ™
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Data-model.md: Data_Entity                     â”‚
â”‚  â”œâ”€ name: "User"                               â”‚
â”‚  â”œâ”€ source_key_entity: "User" (from spec.md) â­â”‚
â”‚  â”œâ”€ fields:                                    â”‚
â”‚  â”‚   â”œâ”€ {name: "email",                        â”‚
â”‚  â”‚   â”‚   type: "String",                       â”‚
â”‚  â”‚   â”‚   constraints: ["unique", "email_format"],â”‚
â”‚  â”‚   â”‚   from_requirement: "FR-002"} â­       â”‚
â”‚  â”‚   â”œâ”€ {name: "password_hash",                â”‚
â”‚  â”‚   â”‚   type: "String",                       â”‚
â”‚  â”‚   â”‚   constraints: ["min_length: 60"],      â”‚
â”‚  â”‚   â”‚   from_requirement: "FR-003"} â­       â”‚
â”‚  â”‚   â”œâ”€ {name: "username",                     â”‚
â”‚  â”‚   â”‚   type: "String",                       â”‚
â”‚  â”‚   â”‚   constraints: ["unique", "min_length: 3"]}â”‚
â”‚  â”‚   â””â”€ {name: "created_at",                   â”‚
â”‚  â”‚       type: "DateTime",                     â”‚
â”‚  â”‚       default: "now()"}                     â”‚
â”‚  â”œâ”€ validation_rules:                          â”‚
â”‚  â”‚   â”œâ”€ "Email must be unique" (from FR-004) â­â”‚
â”‚  â”‚   â””â”€ "Password â‰¥ 8 chars" (from FR-003) â­ â”‚
â”‚  â”œâ”€ relationships:                             â”‚
â”‚  â”‚   â””â”€ {target: "Order",                      â”‚
â”‚  â”‚       type: "one_to_many",                  â”‚
â”‚  â”‚       foreign_key: "user_id"}ï¼ˆæŠ€æœ¯ç»†åŒ–ï¼‰   â”‚
â”‚  â”œâ”€ related_user_stories: ["US1", "US2"] â­   â”‚
â”‚  â””â”€ used_in_endpoints:                         â”‚
â”‚      â””â”€ ["/api/v1/auth/register", ...] â­     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Tasks å‘½ä»¤ç”Ÿæˆ Model å®ç°ä»»åŠ¡
                    â”‚ åŒ…å«éªŒè¯è§„åˆ™å’Œå…³ç³»æ˜ å°„
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tasks.md: Phase 3 (User Story 1)               â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ T012 [P] [US1] Create User model           â”‚
â”‚  â”‚   in src/models/user.py                     â”‚
â”‚  â”‚   â”œâ”€ task_type: "Model"                     â”‚
â”‚  â”‚   â”œâ”€ related_entities: ["User"] â­         â”‚
â”‚  â”‚   â”œâ”€ related_endpoints:                     â”‚
â”‚  â”‚   â”‚   â””â”€ ["/api/v1/auth/register"] â­      â”‚
â”‚  â”‚   â”œâ”€ related_functional_requirements:       â”‚
â”‚  â”‚   â”‚   â””â”€ ["FR-001", "FR-002", "FR-003",     â”‚
â”‚  â”‚   â”‚       "FR-004"] â­                      â”‚
â”‚  â”‚   â””â”€ implementation_notes:                  â”‚
â”‚  â”‚       "Include validation rules from        â”‚
â”‚  â”‚        FR-002, FR-003, FR-004"              â”‚
â”‚  â”‚                                              â”‚
â”‚  â””â”€ T014 [US1] Implement AuthService           â”‚
â”‚      â”œâ”€ depends_on: T012 (User model) â­      â”‚
â”‚      â””â”€ file: src/services/auth_service.py     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å±æ€§æ˜ å°„ç¤ºä¾‹

| Spec.md (æ¦‚å¿µ) | Data-model.md (æŠ€æœ¯) | Tasks.md (å®ç°) |
|----------------|---------------------|-----------------|
| "é‚®ç®±" | `email: String, unique, email_format` | `Create User model with email field` |
| "å¯†ç " | `password_hash: String, bcrypt` | `Hash password in AuthService` |
| "ç”¨æˆ·å" | `username: String, unique, 3-50 chars` | `Validate username in model` |
| "æ³¨å†Œæ—¶é—´" | `created_at: DateTime, auto` | `Auto-generate timestamp` |

---

## ğŸ”„ å…³ç³»é“¾è·¯ 3: åŠŸèƒ½éœ€æ±‚ â†’ éªŒè¯è§„åˆ™ â†’ å®ç°ä»»åŠ¡

å±•ç¤ºåŠŸèƒ½éœ€æ±‚å¦‚ä½•è½¬åŒ–ä¸ºå…·ä½“çš„éªŒè¯é€»è¾‘ã€‚

### æ¼”è¿›æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Spec.md: Functional_Requirement                â”‚
â”‚  â”œâ”€ FR-002: "System MUST validate              â”‚
â”‚  â”‚           email addresses"                   â”‚
â”‚  â”œâ”€ testable: true                             â”‚
â”‚  â””â”€ related_user_stories: ["US1"]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Plan å‘½ä»¤è½¬åŒ–ä¸ºéªŒè¯è§„åˆ™
                    â”‚ åˆ†å¸ƒåˆ°æ•°æ®æ¨¡å‹å’Œ API å¥‘çº¦ä¸­
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
        â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Data-model.md    â”‚    â”‚ Contracts/       â”‚
â”‚                  â”‚    â”‚ auth.yaml        â”‚
â”‚ Data_Entity:     â”‚    â”‚                  â”‚
â”‚ validation_rules:â”‚    â”‚ API_Endpoint:    â”‚
â”‚  â”œâ”€ rule: "Email â”‚    â”‚ validation_rules:â”‚
â”‚  â”‚   must match  â”‚    â”‚  â”œâ”€ field: "emailâ”‚
â”‚  â”‚   RFC 5322"   â”‚    â”‚  â”‚   rule: "emailâ”‚
â”‚  â”‚   related_fr: â”‚    â”‚  â”‚   _format"    â”‚
â”‚  â”‚   "FR-002" â­ â”‚    â”‚  â”‚   from: "FR-  â”‚
â”‚  â””â”€ rule: "Email â”‚    â”‚  â”‚   002" â­     â”‚
â”‚      must be     â”‚    â”‚  â””â”€ error: 400   â”‚
â”‚      unique"     â”‚    â”‚      "Invalid    â”‚
â”‚      related_fr: â”‚    â”‚      email"      â”‚
â”‚      "FR-004" â­ â”‚    â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ Tasks å‘½ä»¤ç”ŸæˆéªŒè¯å®ç°ä»»åŠ¡
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tasks.md: Phase 3 (User Story 1)               â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ T012 [P] [US1] Create User model           â”‚
â”‚  â”‚   â””â”€ å®ç°å­—æ®µçº§éªŒè¯ï¼ˆemail_formatï¼‰         â”‚
â”‚  â”‚                                              â”‚
â”‚  â”œâ”€ T015 [US1] Implement POST                  â”‚
â”‚  â”‚   /api/v1/auth/register endpoint            â”‚
â”‚  â”‚   â””â”€ å®ç° API è¯·æ±‚éªŒè¯                      â”‚
â”‚  â”‚                                              â”‚
â”‚  â””â”€ T016 [US1] Add validation and error        â”‚
â”‚      handling                                   â”‚
â”‚      â”œâ”€ file: src/api/validators/              â”‚
â”‚      â”‚   auth_validator.py                     â”‚
â”‚      â”œâ”€ related_functional_requirements:       â”‚
â”‚      â”‚   â””â”€ ["FR-002", "FR-003"] â­           â”‚
â”‚      â””â”€ implementation_notes:                  â”‚
â”‚          "- Validate email format (FR-002)     â”‚
â”‚           - Validate password length (FR-003)  â”‚
â”‚           - Return appropriate error codes"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éªŒè¯è§„åˆ™åˆ†å¸ƒçŸ©é˜µ

| Functional Requirement | Data Model å±‚ | API å±‚ | Service å±‚ | å®ç°ä»»åŠ¡ |
|------------------------|---------------|--------|------------|----------|
| FR-002: Email éªŒè¯ | âœ… å­—æ®µçº¦æŸ | âœ… è¯·æ±‚éªŒè¯ | âœ… ä¸šåŠ¡é€»è¾‘ | T012, T016 |
| FR-003: å¯†ç é•¿åº¦ | âœ… å­—æ®µçº¦æŸ | âœ… è¯·æ±‚éªŒè¯ | âœ… Hash å‰æ£€æŸ¥ | T012, T016 |
| FR-004: Email å”¯ä¸€ | âœ… å”¯ä¸€ç´¢å¼• | âœ… 409 é”™è¯¯ | âœ… é‡å¤æ£€æŸ¥ | T012, T014, T016 |

---

## ğŸ”„ å…³ç³»é“¾è·¯ 4: éªŒæ”¶åœºæ™¯ â†’ æµ‹è¯•åœºæ™¯ â†’ æµ‹è¯•ä»»åŠ¡

å±•ç¤ºç”¨æˆ·éªŒæ”¶æ ‡å‡†å¦‚ä½•è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„æµ‹è¯•ã€‚

### æ¼”è¿›æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Spec.md: User_Story.acceptance_scenarios       â”‚
â”‚                                                 â”‚
â”‚ User_Story: "US1"                               â”‚
â”‚ â”œâ”€ Scenario 1:                                  â”‚
â”‚ â”‚   â”œâ”€ given: "æ–°ç”¨æˆ·è®¿é—®æ³¨å†Œé¡µé¢"             â”‚
â”‚ â”‚   â”œâ”€ when: "å¡«å†™æœ‰æ•ˆçš„é‚®ç®±å’Œå¯†ç å¹¶æäº¤"       â”‚
â”‚ â”‚   â””â”€ then: "è´¦æˆ·åˆ›å»ºæˆåŠŸï¼Œæ”¶åˆ°ç¡®è®¤é‚®ä»¶" â­   â”‚
â”‚ â””â”€ Scenario 2:                                  â”‚
â”‚     â”œâ”€ given: "ç”¨æˆ·å°è¯•ä½¿ç”¨å·²å­˜åœ¨çš„é‚®ç®±æ³¨å†Œ"   â”‚
â”‚     â”œâ”€ when: "æäº¤æ³¨å†Œè¡¨å•"                     â”‚
â”‚     â””â”€ then: "æ˜¾ç¤ºé”™è¯¯æç¤ºï¼šé‚®ç®±å·²è¢«ä½¿ç”¨" â­   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Plan å‘½ä»¤è½¬åŒ–ä¸ºæµ‹è¯•åœºæ™¯
                    â”‚ æ·»åŠ  API è°ƒç”¨å’ŒéªŒè¯æ­¥éª¤
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Quickstart.md: Test_Scenario                   â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ id: "TS-US1-001"                            â”‚
â”‚  â”œâ”€ source_user_story: "US1" â­                â”‚
â”‚  â”œâ”€ source_acceptance_scenario: 1 â­           â”‚
â”‚  â”œâ”€ title: "æˆåŠŸæ³¨å†Œæ–°ç”¨æˆ·"                     â”‚
â”‚  â”œâ”€ steps:                                      â”‚
â”‚  â”‚   â”œâ”€ Step 1: POST /api/v1/auth/register â­ â”‚
â”‚  â”‚   â”‚   â””â”€ expected: "201 Created"            â”‚
â”‚  â”‚   â”œâ”€ Step 2: Check database                 â”‚
â”‚  â”‚   â”‚   â””â”€ expected: "User exists"            â”‚
â”‚  â”‚   â””â”€ Step 3: Check email queue              â”‚
â”‚  â”‚       â””â”€ expected: "Confirmation sent" â­   â”‚
â”‚  â””â”€ covers_functional_requirements:             â”‚
â”‚      â””â”€ ["FR-001", "FR-002", "FR-003"]          â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ id: "TS-US1-002"                            â”‚
â”‚  â”œâ”€ source_acceptance_scenario: 2 â­           â”‚
â”‚  â””â”€ steps:                                      â”‚
â”‚      â””â”€ Step 1: POST with existing email       â”‚
â”‚          â””â”€ expected: "409 Conflict" â­        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Tasks å‘½ä»¤ç”Ÿæˆæµ‹è¯•ä»»åŠ¡
                    â”‚ (ä»…åœ¨è¯·æ±‚æµ‹è¯•æ—¶)
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tasks.md: Phase 3 (User Story 1) - Tests       â”‚
â”‚                                                 â”‚
â”‚ âš ï¸ NOTE: æµ‹è¯•ä»»åŠ¡æ˜¯å¯é€‰çš„                       â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ T010 [P] [US1] Contract test for           â”‚
â”‚  â”‚   POST /api/v1/auth/register                â”‚
â”‚  â”‚   â”œâ”€ file: tests/contract/                  â”‚
â”‚  â”‚   â”‚   test_auth_register.py                 â”‚
â”‚  â”‚   â”œâ”€ test_scenarios: ["TS-US1-001",         â”‚
â”‚  â”‚   â”‚   "TS-US1-002"] â­                      â”‚
â”‚  â”‚   â””â”€ covers:                                 â”‚
â”‚  â”‚       - 201 response (Scenario 1)           â”‚
â”‚  â”‚       - 409 response (Scenario 2) â­        â”‚
â”‚  â”‚                                              â”‚
â”‚  â””â”€ T011 [P] [US1] Integration test for        â”‚
â”‚      user registration journey                  â”‚
â”‚      â”œâ”€ file: tests/integration/                â”‚
â”‚      â”‚   test_user_registration.py             â”‚
â”‚      â”œâ”€ test_scenarios: ["TS-US1-001",         â”‚
â”‚      â”‚   "TS-US1-002"] â­                      â”‚
â”‚      â””â”€ covers_acceptance_scenarios:            â”‚
â”‚          â””â”€ [1, 2] (from US1) â­               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµ‹è¯•è¦†ç›–çŸ©é˜µ

| Acceptance Scenario | Test Scenario | Test Task | æµ‹è¯•ç±»å‹ |
|---------------------|---------------|-----------|----------|
| US1-Scenario 1: æˆåŠŸæ³¨å†Œ | TS-US1-001 | T010 (Contract)<br/>T011 (Integration) | API å¥‘çº¦<br/>ç«¯åˆ°ç«¯ |
| US1-Scenario 2: é‡å¤é‚®ç®± | TS-US1-002 | T010 (Contract)<br/>T011 (Integration) | API å¥‘çº¦<br/>ç«¯åˆ°ç«¯ |

---

## ğŸ”„ å…³ç³»é“¾è·¯ 5: ä¼˜å…ˆçº§é©±åŠ¨çš„é˜¶æ®µæ¼”è¿›

å±•ç¤ºç”¨æˆ·æ•…äº‹çš„ä¼˜å…ˆçº§å¦‚ä½•å†³å®šå®æ–½é¡ºåºã€‚

### æ¼”è¿›æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Spec.md: User_Story ä¼˜å…ˆçº§åˆ†é…                  â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ US1: priority="P1"                          â”‚
â”‚  â”‚   â””â”€ "ç”¨æˆ·æ³¨å†Œ" â†’ MVP æ ¸å¿ƒåŠŸèƒ½ â­            â”‚
â”‚  â”‚                                              â”‚
â”‚  â”œâ”€ US2: priority="P2"                          â”‚
â”‚  â”‚   â””â”€ "ç”¨æˆ·ç™»å½•" â†’ ç¬¬äºŒä¼˜å…ˆçº§ â­              â”‚
â”‚  â”‚                                              â”‚
â”‚  â””â”€ US3: priority="P3"                          â”‚
â”‚      â””â”€ "å¯†ç é‡ç½®" â†’ ç¬¬ä¸‰ä¼˜å…ˆçº§ â­              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Tasks å‘½ä»¤æŒ‰ä¼˜å…ˆçº§ç»„ç»‡é˜¶æ®µ
                    â”‚ P1 â†’ Phase 3, P2 â†’ Phase 4, P3 â†’ Phase 5
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tasks.md: Phase ç»„ç»‡                            â”‚
â”‚                                                 â”‚
â”‚ Phase 1: Setup                                  â”‚
â”‚   â””â”€ å…±äº«åŸºç¡€è®¾æ–½ï¼ˆé¡¹ç›®åˆå§‹åŒ–ï¼‰                 â”‚
â”‚                                                 â”‚
â”‚ Phase 2: Foundational âš ï¸ é˜»å¡æ‰€æœ‰ç”¨æˆ·æ•…äº‹      â”‚
â”‚   â””â”€ å¿…é¡»å®Œæˆæ‰èƒ½å¼€å§‹ä»»ä½•ç”¨æˆ·æ•…äº‹               â”‚
â”‚                                                 â”‚
â”‚ Phase 3: User Story 1 (P1) â† MVP èŒƒå›´ ğŸ¯       â”‚
â”‚   â”œâ”€ user_story_ref: "US1" â­                  â”‚
â”‚   â”œâ”€ goal: "å®ç°ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½"                   â”‚
â”‚   â”œâ”€ independent_test: "ç”¨æˆ·å¯ä»¥æˆåŠŸæ³¨å†Œå¹¶æ”¶åˆ°   â”‚
â”‚   â”‚                      ç¡®è®¤é‚®ä»¶" â­          â”‚
â”‚   â”œâ”€ depends_on_phases: [2]                    â”‚
â”‚   â””â”€ tasks: [T010-T017] all tagged [US1] â­   â”‚
â”‚                                                 â”‚
â”‚ Phase 4: User Story 2 (P2) â† å¢é‡äº¤ä»˜          â”‚
â”‚   â”œâ”€ user_story_ref: "US2" â­                  â”‚
â”‚   â”œâ”€ goal: "å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½"                   â”‚
â”‚   â”œâ”€ independent_test: "æ³¨å†Œç”¨æˆ·å¯ä»¥æˆåŠŸç™»å½•"   â”‚
â”‚   â”œâ”€ depends_on_phases: [2] â† ç‹¬ç«‹äº US1! â­  â”‚
â”‚   â””â”€ tasks: [T018-T023] all tagged [US2] â­   â”‚
â”‚                                                 â”‚
â”‚ Phase 5: User Story 3 (P3) â† å¢é‡äº¤ä»˜          â”‚
â”‚   â”œâ”€ user_story_ref: "US3" â­                  â”‚
â”‚   â”œâ”€ goal: "å®ç°å¯†ç é‡ç½®åŠŸèƒ½"                   â”‚
â”‚   â”œâ”€ independent_test: "ç”¨æˆ·å¯ä»¥é€šè¿‡é‚®ä»¶é‡ç½®å¯†ç "â”‚
â”‚   â”œâ”€ depends_on_phases: [2] â† ç‹¬ç«‹äº US1, US2!â­â”‚
â”‚   â””â”€ tasks: [T024-T028] all tagged [US3] â­   â”‚
â”‚                                                 â”‚
â”‚ Phase N: Polish                                 â”‚
â”‚   â””â”€ è·¨æ•…äº‹çš„æ”¹è¿›å’Œä¼˜åŒ–                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ æ”¯æŒå¤šç§äº¤ä»˜ç­–ç•¥
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Implementation_Strategy                         â”‚
â”‚                                                 â”‚
â”‚ 1. MVP First (æœ€å°å¯è¡Œäº§å“):                    â”‚
â”‚    Phase 1 â†’ Phase 2 â†’ Phase 3 (US1) â†’ éƒ¨ç½² ğŸ¯ â”‚
â”‚    â””â”€ åªå®ç° P1 ç”¨æˆ·æ•…äº‹ï¼Œå¿«é€ŸéªŒè¯ä»·å€¼          â”‚
â”‚                                                 â”‚
â”‚ 2. Incremental (å¢é‡äº¤ä»˜):                      â”‚
â”‚    â”œâ”€ Phase 3 å®Œæˆ â†’ æµ‹è¯• US1 â†’ éƒ¨ç½²            â”‚
â”‚    â”œâ”€ Phase 4 å®Œæˆ â†’ æµ‹è¯• US2 â†’ éƒ¨ç½²            â”‚
â”‚    â””â”€ Phase 5 å®Œæˆ â†’ æµ‹è¯• US3 â†’ éƒ¨ç½²            â”‚
â”‚    â””â”€ æ¯ä¸ªæ•…äº‹ç‹¬ç«‹äº¤ä»˜ä»·å€¼ â­                   â”‚
â”‚                                                 â”‚
â”‚ 3. Parallel Team (å¹¶è¡Œå›¢é˜Ÿ):                    â”‚
â”‚    Foundational (Phase 2) å®Œæˆåï¼š              â”‚
â”‚    â”œâ”€ Developer A â†’ US1 (Phase 3)               â”‚
â”‚    â”œâ”€ Developer B â†’ US2 (Phase 4)               â”‚
â”‚    â””â”€ Developer C â†’ US3 (Phase 5)               â”‚
â”‚    â””â”€ æ•…äº‹å¯ç‹¬ç«‹å¼€å‘å’Œé›†æˆ â­                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¼˜å…ˆçº§åˆ°é˜¶æ®µçš„æ˜ å°„

| User Story | Priority | Phase | MVP | ç‹¬ç«‹æ€§ |
|------------|----------|-------|-----|--------|
| US1: ç”¨æˆ·æ³¨å†Œ | P1 | Phase 3 | âœ… åŒ…å« | âœ… å¯ç‹¬ç«‹æµ‹è¯• |
| US2: ç”¨æˆ·ç™»å½• | P2 | Phase 4 | âŒ å¢é‡ | âœ… å¯ç‹¬ç«‹æµ‹è¯•ï¼ˆä¾èµ– Foundationalï¼Œä¸ä¾èµ– US1ï¼‰ |
| US3: å¯†ç é‡ç½® | P3 | Phase 5 | âŒ å¢é‡ | âœ… å¯ç‹¬ç«‹æµ‹è¯•ï¼ˆä¾èµ– Foundationalï¼Œä¸ä¾èµ– US1/US2ï¼‰ |

---

## ğŸ”„ å…³ç³»é“¾è·¯ 6: NEEDS CLARIFICATION â†’ ç ”ç©¶å†³ç­– â†’ æŠ€æœ¯é€‰å‹

å±•ç¤ºæœªæ˜ç¡®çš„éœ€æ±‚å¦‚ä½•é€šè¿‡ç ”ç©¶è½¬åŒ–ä¸ºæŠ€æœ¯å†³ç­–ã€‚

### æ¼”è¿›æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Spec.md: Functional_Requirement (æœªæ˜ç¡®)        â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ FR-006: "System MUST authenticate users viaâ”‚
â”‚  â”‚   [NEEDS CLARIFICATION: auth method not     â”‚
â”‚  â”‚    specified - email/password, SSO, OAuth?]"â”‚
â”‚  â””â”€ needs_clarification: true â­               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Clarify æµç¨‹ æˆ– Plan å‘½ä»¤ç ”ç©¶
                    â”‚ è¯„ä¼°å¤šç§æ–¹æ¡ˆï¼Œåšå‡ºå†³ç­–
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Research.md: Research_Decision                 â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ topic: "Authentication Method"             â”‚
â”‚  â”œâ”€ source_clarification: "FR-006" â­          â”‚
â”‚  â”œâ”€ decision: "JWT with OAuth2                 â”‚
â”‚  â”‚   (Google + GitHub providers)"              â”‚
â”‚  â”œâ”€ rationale: "Industry standard, supports    â”‚
â”‚  â”‚   social login, stateless, suitable for     â”‚
â”‚  â”‚   mobile API"                                â”‚
â”‚  â”œâ”€ alternatives_considered:                    â”‚
â”‚  â”‚   â”œâ”€ Session-based: "Not suitable for       â”‚
â”‚  â”‚   â”‚   mobile API"                            â”‚
â”‚  â”‚   â””â”€ API Keys: "Less secure for user        â”‚
â”‚  â”‚       accounts"                              â”‚
â”‚  â””â”€ related_functional_requirements:            â”‚
â”‚      â””â”€ ["FR-006", "FR-001"] â­                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ å½±å“æŠ€æœ¯ä¸Šä¸‹æ–‡å’Œä¾èµ–
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Plan.md: Technical_Context                     â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ language_version: "Python 3.11"            â”‚
â”‚  â”œâ”€ primary_dependencies:                      â”‚
â”‚  â”‚   â”œâ”€ "FastAPI"                               â”‚
â”‚  â”‚   â”œâ”€ "python-jose[cryptography]" â­         â”‚
â”‚  â”‚   â”œâ”€ "authlib" â­                           â”‚
â”‚  â”‚   â””â”€ "httpx" â­                             â”‚
â”‚  â””â”€ derived_from_research:                      â”‚
â”‚      "JWT + OAuth2 decision from research.md" â­â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ å½±å“ä»»åŠ¡ç”Ÿæˆ
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tasks.md: Phase 2 (Foundational)               â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ T005 [P] Implement JWT authentication      â”‚
â”‚  â”‚   middleware                                 â”‚
â”‚  â”‚   â”œâ”€ file: src/middleware/auth.py           â”‚
â”‚  â”‚   â”œâ”€ implementation_notes:                  â”‚
â”‚  â”‚   â”‚   "Use python-jose for JWT handling"    â”‚
â”‚  â”‚   â””â”€ related_functional_requirements:       â”‚
â”‚  â”‚       ["FR-006"] â­                         â”‚
â”‚  â”‚                                              â”‚
â”‚  â””â”€ T006 [P] Setup OAuth2 provider integrationsâ”‚
â”‚      â”œâ”€ file: src/services/oauth_service.py    â”‚
â”‚      â”œâ”€ implementation_notes:                  â”‚
â”‚      â”‚   "Integrate Google and GitHub OAuth2   â”‚
â”‚      â”‚    using authlib"                        â”‚
â”‚      â””â”€ derived_from_decision:                  â”‚
â”‚          "research.md: Authentication Method" â­â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å†³ç­–å½±å“çŸ©é˜µ

| ç ”ç©¶å†³ç­– | å½±å“çš„æ–‡ä»¶ | å…·ä½“å½±å“ | äº§ç”Ÿçš„ä»»åŠ¡ |
|----------|-----------|----------|-----------|
| JWT + OAuth2 | plan.md | æ·»åŠ ä¾èµ–: python-jose, authlib | T005, T006 |
| JWT + OAuth2 | data-model.md | User éœ€è¦ oauth_provider å­—æ®µ | T012 (æ›´æ–° User æ¨¡å‹) |
| JWT + OAuth2 | contracts/*.yaml | æ·»åŠ  /auth/oauth/google ç«¯ç‚¹ | T015 (æ–°ç«¯ç‚¹) |

---

## ğŸ”„ å…³ç³»é“¾è·¯ 7: æˆåŠŸæ ‡å‡† â†’ æµ‹è¯•éªŒè¯ â†’ è´¨é‡é—¨ç¦

å±•ç¤ºå¦‚ä½•éªŒè¯åŠŸèƒ½æ˜¯å¦è¾¾åˆ°é¢„æœŸç›®æ ‡ã€‚

### æ¼”è¿›æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Spec.md: Success_Criteria                      â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ SC-001: "Users can complete registration   â”‚
â”‚  â”‚   in under 2 minutes"                        â”‚
â”‚  â”‚   â”œâ”€ measurable: true â­                    â”‚
â”‚  â”‚   â”œâ”€ technology_agnostic: true â­           â”‚
â”‚  â”‚   â””â”€ related_user_stories: ["US1"]          â”‚
â”‚  â”‚                                              â”‚
â”‚  â””â”€ SC-002: "System handles 1000 concurrent    â”‚
â”‚      users without degradation"                 â”‚
â”‚      â”œâ”€ measurable: true â­                    â”‚
â”‚      â””â”€ related_user_stories: ["US1", "US2"]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Plan å‘½ä»¤è½¬åŒ–ä¸ºæµ‹è¯•åœºæ™¯
                    â”‚ å®šä¹‰å¦‚ä½•åº¦é‡
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Quickstart.md: Test_Scenario                   â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ id: "TS-US1-PERF-001"                       â”‚
â”‚  â”œâ”€ title: "Measure registration time"         â”‚
â”‚  â”œâ”€ source_success_criteria: "SC-001" â­       â”‚
â”‚  â”œâ”€ steps:                                      â”‚
â”‚  â”‚   â”œâ”€ Start timer                             â”‚
â”‚  â”‚   â”œâ”€ Navigate to registration page          â”‚
â”‚  â”‚   â”œâ”€ Fill form                               â”‚
â”‚  â”‚   â”œâ”€ Submit                                  â”‚
â”‚  â”‚   â”œâ”€ Wait for confirmation email            â”‚
â”‚  â”‚   â””â”€ Stop timer                              â”‚
â”‚  â””â”€ expected: "Total time < 2 minutes" â­      â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ id: "TS-LOAD-001"                           â”‚
â”‚  â”œâ”€ title: "Load test with 1000 users"         â”‚
â”‚  â”œâ”€ source_success_criteria: "SC-002" â­       â”‚
â”‚  â””â”€ expected: "No degradation at 1000           â”‚
â”‚      concurrent users" â­                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Tasks å‘½ä»¤ç”ŸæˆéªŒè¯ä»»åŠ¡
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tasks.md: Phase N (Polish)                     â”‚
â”‚                                                 â”‚
â”‚  â”œâ”€ TXXX Run quickstart.md validation          â”‚
â”‚  â”‚   â””â”€ Verify all test scenarios pass         â”‚
â”‚  â”‚                                              â”‚
â”‚  â”œâ”€ TXXX Performance test for SC-001           â”‚
â”‚  â”‚   â”œâ”€ file: tests/performance/               â”‚
â”‚  â”‚   â”‚   test_registration_time.py             â”‚
â”‚  â”‚   â””â”€ related_success_criteria: ["SC-001"] â­â”‚
â”‚  â”‚                                              â”‚
â”‚  â””â”€ TXXX Load test for SC-002                  â”‚
â”‚      â”œâ”€ file: tests/load/test_concurrent.py    â”‚
â”‚      â””â”€ related_success_criteria: ["SC-002"] â­â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ ä» User_Story å‡ºå‘çš„å®Œæ•´å…³ç³»å…¨æ™¯

### æ ¸å¿ƒè§†è§’ï¼šä¸€ä¸ªç”¨æˆ·æ•…äº‹å¦‚ä½•é©±åŠ¨æ•´ä¸ªç³»ç»Ÿ

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   User_Story (US1)               â”‚
                        â”‚   â”œâ”€ id: "US1"                   â”‚
                        â”‚   â”œâ”€ priority: "P1"              â”‚
                        â”‚   â”œâ”€ user_actions: [...]         â”‚
                        â”‚   â”œâ”€ acceptance_scenarios: [...]  â”‚
                        â”‚   â”œâ”€ related_entities: [...]     â”‚
                        â”‚   â”œâ”€ related_FRs: [...]          â”‚
                        â”‚   â””â”€ independent_test: "..."     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚               â”‚               â”‚             â”‚             â”‚
   [ä¼˜å…ˆçº§]       [ç”¨æˆ·åŠ¨ä½œ]      [éªŒæ”¶åœºæ™¯]     [å…³è”å®ä½“]    [åŠŸèƒ½éœ€æ±‚]   [ç‹¬ç«‹æµ‹è¯•]
        â”‚             â”‚               â”‚               â”‚             â”‚             â”‚
        â†“             â†“               â†“               â†“             â†“             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Phase 3  â”‚  â”‚   API    â”‚  â”‚   Test   â”‚  â”‚   Key    â”‚   â”‚Functionalâ”‚  â”‚Checkpointâ”‚
  â”‚(tasks.md)â”‚  â”‚ Endpoint â”‚  â”‚ Scenario â”‚  â”‚  Entity  â”‚   â”‚   Req    â”‚  â”‚(tasks.md)â”‚
  â”‚          â”‚  â”‚(contractsâ”‚  â”‚(quickstrtâ”‚  â”‚(spec.md) â”‚   â”‚(spec.md) â”‚  â”‚          â”‚
  â”‚US1 Phase â”‚  â”‚   /)     â”‚  â”‚   )      â”‚  â”‚          â”‚   â”‚          â”‚  â”‚"ç”¨æˆ·å¯ä»¥  â”‚
  â”‚          â”‚  â”‚POST /reg â”‚  â”‚TS-US1-001â”‚  â”‚  User    â”‚   â”‚  FR-002  â”‚  â”‚ æˆåŠŸæ³¨å†Œ" â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  FR-003  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚               â”‚            â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
        â”‚             â”‚               â”‚            â”‚             â”‚              â”‚
        â†“             â†“               â†“            â†“             â†“              â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Tasks   â”‚  â”‚ Endpoint â”‚  â”‚   Test   â”‚  â”‚ Data_Entity â”‚  â”‚Validationâ”‚  â”‚  Phase   â”‚
  â”‚  List    â”‚  â”‚  Tasks   â”‚  â”‚  Tasks   â”‚  â”‚(data-model) â”‚  â”‚  Rules   â”‚  â”‚ Complete â”‚
  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚             â”‚  â”‚          â”‚  â”‚ Verify   â”‚
  â”‚T009-T017 â”‚  â”‚T015 [US1]â”‚  â”‚T009 [US1]â”‚  â”‚ User entity â”‚  â”‚email_fmt â”‚  â”‚          â”‚
  â”‚  [US1]   â”‚  â”‚          â”‚  â”‚T010 [US1]â”‚  â”‚ + fields    â”‚  â”‚passwd_lenâ”‚  â”‚          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         
                                              â”‚                        â”‚                        
                                              â†“                        â†“                        
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                
                                        â”‚ Model Tasks â”‚        â”‚ Validation   â”‚                
                                        â”‚             â”‚        â”‚ Tasks        â”‚                
                                        â”‚ T012 [US1]  â”‚        â”‚ T016 [US1]   â”‚                
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     
```

### å®Œæ•´å…³ç³»é“¾è·¯ï¼šUS1 ç”¨æˆ·æ³¨å†Œç¤ºä¾‹

```yaml
User_Story_US1:
  id: "US1"
  title: "ç”¨æˆ·æ³¨å†Œ"
  priority: "P1"
  
  # åˆ†æ”¯ 1: ä¼˜å…ˆçº§ â†’ æ‰§è¡Œé¡ºåº
  priority_drives:
    - Phase_3_in_tasks_md:
        phase_number: 3
        phase_name: "User Story 1 - ç”¨æˆ·æ³¨å†Œ"
        tasks: ["T009", "T010", "T011", "T012", "T014", "T015", "T016"]
        checkpoint: "ç”¨æˆ·å¯ä»¥æˆåŠŸæ³¨å†Œå¹¶æ”¶åˆ°ç¡®è®¤é‚®ä»¶"
  
  # åˆ†æ”¯ 2: ç”¨æˆ·åŠ¨ä½œ â†’ API ç«¯ç‚¹ â†’ å®ç°ä»»åŠ¡
  user_actions_drive:
    - user_action: "æäº¤æ³¨å†Œ"
      generates:
        - API_Endpoint:
            path: "/api/v1/auth/register"
            method: "POST"
            source_user_story: "US1"
            source_user_action: "æäº¤æ³¨å†Œ"
            file: "contracts/auth.yaml"
            leads_to_tasks:
              - T015:
                  description: "Implement POST /api/v1/auth/register"
                  file: "src/api/v1/auth.py"
                  user_story_label: "[US1]"
                  related_endpoints: ["/api/v1/auth/register"]
  
  # åˆ†æ”¯ 3: éªŒæ”¶åœºæ™¯ â†’ æµ‹è¯•åœºæ™¯ â†’ æµ‹è¯•ä»»åŠ¡
  acceptance_scenarios_drive:
    - scenario_1:
        given: "æ–°ç”¨æˆ·è®¿é—®æ³¨å†Œé¡µé¢"
        when: "å¡«å†™æœ‰æ•ˆçš„é‚®ç®±å’Œå¯†ç å¹¶æäº¤"
        then: "è´¦æˆ·åˆ›å»ºæˆåŠŸï¼Œæ”¶åˆ°ç¡®è®¤é‚®ä»¶"
        generates:
          - Test_Scenario:
              id: "TS-US1-001"
              title: "æˆåŠŸæ³¨å†Œæ–°ç”¨æˆ·"
              source_user_story: "US1"
              source_acceptance_scenario: 1
              file: "quickstart.md"
              leads_to_tasks:
                - T009:
                    description: "Contract test for POST /register"
                    file: "tests/contract/test_auth_register.py"
                    user_story_label: "[US1]"
                    test_scenarios: ["TS-US1-001", "TS-US1-002"]
                - T010:
                    description: "Integration test for registration"
                    file: "tests/integration/test_user_registration.py"
                    user_story_label: "[US1]"
                    covers_acceptance_scenarios: [1, 2]
    
    - scenario_2:
        given: "ç”¨æˆ·å°è¯•ä½¿ç”¨å·²å­˜åœ¨çš„é‚®ç®±æ³¨å†Œ"
        when: "æäº¤æ³¨å†Œè¡¨å•"
        then: "æ˜¾ç¤ºé”™è¯¯æç¤ºï¼šé‚®ç®±å·²è¢«ä½¿ç”¨"
        generates:
          - Test_Scenario:
              id: "TS-US1-002"
              title: "é‡å¤é‚®ç®±æ³¨å†Œå¤±è´¥"
              source_user_story: "US1"
              source_acceptance_scenario: 2
              # åŒæ ·å¯¼å‘ T009, T010
  
  # åˆ†æ”¯ 4: å…³è”å®ä½“ â†’ æ•°æ®æ¨¡å‹ â†’ Model ä»»åŠ¡
  related_entities_drive:
    - Key_Entity:
        name: "User"
        source: "spec.md"
        key_attributes: ["é‚®ç®±", "å¯†ç ", "ç”¨æˆ·å", "æ³¨å†Œæ—¶é—´"]
        generates:
          - Data_Entity:
              name: "User"
              source_key_entity: "User"
              file: "data-model.md"
              fields:
                - {name: "email", type: "String", from_requirement: "FR-002"}
                - {name: "password_hash", type: "String", from_requirement: "FR-003"}
                - {name: "username", type: "String"}
                - {name: "created_at", type: "DateTime"}
              related_user_stories: ["US1", "US2"]
              used_in_endpoints: ["/api/v1/auth/register"]
              leads_to_tasks:
                - T012:
                    description: "Create User model"
                    file: "src/models/user.py"
                    user_story_label: "[US1]"
                    related_entities: ["User"]
                    related_FRs: ["FR-001", "FR-002", "FR-003", "FR-004"]
  
  # åˆ†æ”¯ 5: åŠŸèƒ½éœ€æ±‚ â†’ éªŒè¯è§„åˆ™ â†’ éªŒè¯ä»»åŠ¡
  related_functional_requirements_drive:
    - FR_002:
        description: "ç³»ç»Ÿå¿…é¡»éªŒè¯é‚®ç®±åœ°å€æ ¼å¼"
        generates:
          - Data_Entity_validation:
              entity: "User"
              rule: "Email must match RFC 5322 format"
              related_fr: "FR-002"
              file: "data-model.md"
          - API_Endpoint_validation:
              endpoint: "/api/v1/auth/register"
              field: "email"
              rule: "email_format"
              from_requirement: "FR-002"
              file: "contracts/auth.yaml"
          - leads_to_tasks:
              - T012:
                  task: "Implement email validation in User model"
              - T016:
                  description: "Add validation and error handling"
                  file: "src/api/validators/auth_validator.py"
                  user_story_label: "[US1]"
                  related_FRs: ["FR-002", "FR-003"]
    
    - FR_003:
        description: "å¯†ç å¿…é¡»è‡³å°‘åŒ…å« 8 ä¸ªå­—ç¬¦"
        generates:
          - Data_Entity_validation:
              entity: "User"
              rule: "Password minimum 8 characters"
              related_fr: "FR-003"
          - API_Endpoint_validation:
              endpoint: "/api/v1/auth/register"
              field: "password"
              rule: "min_length: 8"
              from_requirement: "FR-003"
          - leads_to_tasks:
              - T012:
                  task: "Implement password validation in User model"
              - T016:
                  task: "Validate password length in API"
  
  # åˆ†æ”¯ 6: Service å±‚ä»»åŠ¡ï¼ˆåè°ƒï¼‰
  service_layer_tasks:
    - T014:
        description: "Implement AuthService.register()"
        file: "src/services/auth_service.py"
        user_story_label: "[US1]"
        depends_on: ["T012"]  # User model
        orchestrates:
          - "Validate email and password"
          - "Check email uniqueness"
          - "Hash password"
          - "Create user record"
          - "Send confirmation email"
        related_FRs: ["FR-001", "FR-002", "FR-003", "FR-004", "FR-005", "FR-006"]
  
  # åˆ†æ”¯ 7: ç‹¬ç«‹æµ‹è¯•æ ‡å‡† â†’ Checkpoint
  independent_test_drives:
    - criterion: "ç”¨æˆ·å¯ä»¥æˆåŠŸæ³¨å†Œå¹¶æ”¶åˆ°ç¡®è®¤é‚®ä»¶"
      generates:
        - Checkpoint:
            phase: 3
            description: "At this point, User Story 1 should be fully functional and testable independently"
            verification_steps:
              - "All US1 tasks completed"
              - "US1 independent test passes"
              - "No dependencies on incomplete features"
```

### ä»»åŠ¡ä¾èµ–å…³ç³»ï¼ˆUS1 å†…éƒ¨ï¼‰

```
US1 Tasks Dependency Graph:

[T009] Contract test â”€â”€â”€â”€â”
                         â”‚
[T010] Integration test â”€â”¤ å¯å¹¶è¡Œ [P]
                         â”‚
[T012] User model â”€â”€â”€â”€â”€â”€â”€â”¤ å¯å¹¶è¡Œ [P]
         â”‚               â”‚
         â†“               â”‚
[T014] AuthService â”€â”€â”€â”€â”€â”€â”¤ ä¾èµ– T012
         â”‚               â”‚
         â†“               â”‚
[T015] POST /register â”€â”€â”€â”¤ ä¾èµ– T014
         â”‚               â”‚
[T016] Validation â”€â”€â”€â”€â”€â”€â”€â”˜ å¯ä¸ T015 å¹¶è¡Œ [P]

Execution Order:
1. [P] T009, T010, T012 å¯ä»¥å¹¶è¡Œå¼€å§‹
2. T014 ç­‰å¾… T012 å®Œæˆ
3. T015 ç­‰å¾… T014 å®Œæˆ
4. [P] T016 å¯ä»¥ä¸ T015 å¹¶è¡Œï¼ˆä¸åŒæ–‡ä»¶ï¼‰
```

### è·¨é˜¶æ®µè¿½æº¯ç¤ºä¾‹

```
é—®é¢˜ï¼šUS1 çš„"æäº¤æ³¨å†Œ"ç”¨æˆ·åŠ¨ä½œå¦‚ä½•å˜æˆå¯æ‰§è¡Œä»£ç ï¼Ÿ

Spec.md (Specify é˜¶æ®µ):
  User_Story US1
    â””â”€ user_action: "æäº¤æ³¨å†Œ"
          â”‚
          â†“
Plan.md (Plan é˜¶æ®µ):
  contracts/auth.yaml
    â””â”€ API_Endpoint: POST /api/v1/auth/register
          â”œâ”€ source_user_story: "US1"
          â”œâ”€ source_user_action: "æäº¤æ³¨å†Œ"
          â”œâ”€ request: {email, password, username}
          â””â”€ response: {201, 409, 400}
          â”‚
          â†“
  data-model.md
    â””â”€ Data_Entity: User
          â”œâ”€ fields: email, password_hash, username
          â””â”€ used_in_endpoints: ["/api/v1/auth/register"]
          â”‚
          â†“
Tasks.md (Tasks é˜¶æ®µ):
  Phase 3: User Story 1
    â”œâ”€ T012 [US1] Create User model (src/models/user.py)
    â”‚     â””â”€ related_endpoints: ["/api/v1/auth/register"]
    â”œâ”€ T014 [US1] Implement AuthService.register()
    â”‚     â”œâ”€ depends_on: T012
    â”‚     â””â”€ business logic: validate, hash, create, send email
    â””â”€ T015 [US1] Implement POST /api/v1/auth/register
          â”œâ”€ file: src/api/v1/auth.py
          â”œâ”€ depends_on: T014
          â”œâ”€ source: US1 "æäº¤æ³¨å†Œ" â­ å®Œæ•´è¿½æº¯ï¼
          â””â”€ related_endpoints: ["/api/v1/auth/register"]
```

### å…³è”å®ä½“æ±‡æ€»

ä» US1 å‡ºå‘ï¼Œæ¶‰åŠä»¥ä¸‹æ‰€æœ‰å®ä½“ï¼š

| é˜¶æ®µ | æ–‡ä»¶ | å®ä½“ç±»å‹ | å®ä½“å®ä¾‹ | å…³ç³» |
|------|------|---------|---------|------|
| Specify | spec.md | User_Story | US1 | æºå¤´ â­ |
| Specify | spec.md | Functional_Requirement | FR-001~FR-006 | US1.related_FRs |
| Specify | spec.md | Key_Entity | User | US1.related_entities |
| Specify | spec.md | Acceptance_Scenario | Scenario 1, 2 | US1.acceptance_scenarios |
| Plan | research.md | Research_Decision | JWT, bcrypt | è§£å†³ FR-006 |
| Plan | data-model.md | Data_Entity | User | æ¥è‡ª Key_Entity |
| Plan | contracts/auth.yaml | API_Endpoint | POST /register | æ¥è‡ª user_action |
| Plan | quickstart.md | Test_Scenario | TS-US1-001, 002 | æ¥è‡ª acceptance_scenarios |
| Tasks | tasks.md | Phase | Phase 3 | å¯¹åº” US1 (P1) |
| Tasks | tasks.md | Task | T009~T016 | æ ‡è®° [US1] |

**æ€»è®¡**ï¼š1ä¸ªç”¨æˆ·æ•…äº‹é©±åŠ¨äº† ~15ä¸ªè·¨é˜¶æ®µçš„å®ä½“å®ä¾‹ï¼

---

## ğŸ“Š å®Œæ•´å…³ç³»è¿½æº¯å›¾

```
Spec.md
  â”‚
  â”œâ”€ User_Story (US1, US2, US3...)
  â”‚   â”œâ”€ priority â†’ Phase order in tasks.md
  â”‚   â”œâ”€ user_actions â†’ API_Endpoint in contracts/
  â”‚   â”œâ”€ acceptance_scenarios â†’ Test_Scenario in quickstart.md
  â”‚   â””â”€ related_entities â†’ Data_Entity in data-model.md
  â”‚
  â”œâ”€ Functional_Requirement (FR-001, FR-002...)
  â”‚   â”œâ”€ [NEEDS CLARIFICATION] â†’ Research_Decision in research.md
  â”‚   â”œâ”€ impacts_entities â†’ Data_Entity.validation_rules
  â”‚   â””â”€ testable â†’ Test_Scenario coverage
  â”‚
  â”œâ”€ Success_Criteria (SC-001, SC-002...)
  â”‚   â””â”€ measurable â†’ Performance test scenarios
  â”‚
  â””â”€ Key_Entity
      â””â”€ key_attributes â†’ Data_Entity.fields

Plan.md
  â”‚
  â”œâ”€ Technical_Context
  â”‚   â”œâ”€ derived_from_research â†’ Research_Decision
  â”‚   â””â”€ primary_dependencies â†’ Setup tasks in tasks.md
  â”‚
  â”œâ”€ Project_Structure
  â”‚   â””â”€ directories â†’ Task.file_path in tasks.md
  â”‚
  â””â”€ Constitution_Check
      â””â”€ violations â†’ Complexity_Tracking

Research.md
  â”‚
  â””â”€ Research_Decision
      â”œâ”€ source_clarification â†’ Functional_Requirement
      â”œâ”€ impacts_technical_context â†’ Technical_Context
      â””â”€ impacts_dependencies â†’ Setup tasks

Data-model.md
  â”‚
  â””â”€ Data_Entity
      â”œâ”€ source_key_entity â†’ Key_Entity
      â”œâ”€ validation_rules.related_fr â†’ Functional_Requirement
      â”œâ”€ related_user_stories â†’ User_Story
      â”œâ”€ used_in_endpoints â†’ API_Endpoint
      â””â”€ â†’ Model tasks in tasks.md

Contracts/
  â”‚
  â””â”€ API_Endpoint
      â”œâ”€ source_user_story â†’ User_Story
      â”œâ”€ source_user_action â†’ User_Story.user_actions
      â”œâ”€ implements_requirements â†’ Functional_Requirement
      â”œâ”€ related_data_entities â†’ Data_Entity
      â””â”€ â†’ Endpoint tasks in tasks.md

Quickstart.md
  â”‚
  â””â”€ Test_Scenario
      â”œâ”€ source_user_story â†’ User_Story
      â”œâ”€ source_acceptance_scenario â†’ User_Story.acceptance_scenarios
      â”œâ”€ uses_endpoints â†’ API_Endpoint
      â””â”€ â†’ Test tasks in tasks.md (if requested)

Tasks.md
  â”‚
  â”œâ”€ Phase
  â”‚   â”œâ”€ user_story_ref â†’ User_Story
  â”‚   â””â”€ depends_on_phases â†’ Other Phases
  â”‚
  â””â”€ Task
      â”œâ”€ user_story_label â†’ User_Story
      â”œâ”€ related_entities â†’ Data_Entity
      â”œâ”€ related_endpoints â†’ API_Endpoint
      â”œâ”€ related_functional_requirements â†’ Functional_Requirement
      â”œâ”€ related_test_scenarios â†’ Test_Scenario
      â””â”€ depends_on_tasks â†’ Other Tasks
```

---

## ğŸ¯ å¦‚ä½•ä½¿ç”¨è¿™äº›å…³ç³»é“¾è·¯

### æ­£å‘è¿½æº¯ï¼ˆéœ€æ±‚ â†’ å®ç°ï¼‰

**é—®é¢˜**ï¼š"FR-002 è¿™ä¸ªåŠŸèƒ½éœ€æ±‚åœ¨å“ªé‡Œå®ç°äº†ï¼Ÿ"

**è¿½æº¯è·¯å¾„**ï¼š
1. æŸ¥çœ‹ FR-002 â†’ `related_user_stories` â†’ US1
2. æŸ¥çœ‹ data-model.md â†’ Data_Entity.validation_rules â†’ æ‰¾åˆ° related_fr = "FR-002"
3. æŸ¥çœ‹ contracts/auth.yaml â†’ API_Endpoint.validation_rules â†’ æ‰¾åˆ° from_requirement = "FR-002"
4. æŸ¥çœ‹ tasks.md â†’ æœç´¢ `related_functional_requirements: ["FR-002"]` â†’ T012, T016

### åå‘è¿½æº¯ï¼ˆå®ç° â†’ éœ€æ±‚ï¼‰

**é—®é¢˜**ï¼š"T016 è¿™ä¸ªä»»åŠ¡æ˜¯ä¸ºäº†å®ç°å“ªä¸ªç”¨æˆ·æ•…äº‹ï¼Ÿ"

**è¿½æº¯è·¯å¾„**ï¼š
1. æŸ¥çœ‹ T016 â†’ `user_story_label` â†’ [US1]
2. æŸ¥çœ‹ T016 â†’ `related_functional_requirements` â†’ ["FR-002", "FR-003"]
3. æŸ¥çœ‹ spec.md â†’ User_Story US1 â†’ æŸ¥çœ‹ç›¸å…³åœºæ™¯å’Œä»·å€¼

### å½±å“åˆ†æï¼ˆå˜æ›´ â†’ å½±å“ï¼‰

**é—®é¢˜**ï¼š"å¦‚æœæˆ‘ä¿®æ”¹ FR-002ï¼ˆemail éªŒè¯è§„åˆ™ï¼‰ï¼Œä¼šå½±å“å“ªäº›éƒ¨åˆ†ï¼Ÿ"

**å½±å“è·¯å¾„**ï¼š
1. spec.md: FR-002 å®šä¹‰
2. data-model.md: User.validation_rulesï¼ˆéœ€è¦æ›´æ–°ï¼‰
3. contracts/auth.yaml: API_Endpoint.validation_rulesï¼ˆéœ€è¦æ›´æ–°ï¼‰
4. tasks.md: T012ï¼ˆUser modelï¼‰, T016ï¼ˆValidationï¼‰ï¼ˆéœ€è¦é‡æ–°å®ç°ï¼‰
5. quickstart.md: Test_Scenarioï¼ˆéœ€è¦æ›´æ–°æµ‹è¯•ç”¨ä¾‹ï¼‰

---

**ä¸‹ä¸€æ­¥**ï¼šæŸ¥çœ‹ [04-evolution-roadmap.md](./04-evolution-roadmap.md) äº†è§£å®Œæ•´çš„æ¼”è¿›è·¯çº¿å›¾ã€‚

